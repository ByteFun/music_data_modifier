<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>曲线救国——如何让WP/Win10M用上扫码付款功能 - Ex-cited!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/css/cosmo-custom.min.css">
    <link rel="stylesheet" type="text/css" href="/css/sce-add.css">
    <link rel="shortcut icon" href="/favicon.ico">
  </head>

  <body>
    <nav id="navbar" class="navbar navbar-default navbar-fixed-top"></nav>

    <div class="container">

      <div class="row">
        <div class="col-lg-12 page-header">
          <h2><strong>曲线救国——如何让WP/Win10M用上扫码付款功能</strong></h2>
        </div>
      </div>

      <div class="row">

        <div class="col-md-8">
          <p>先列原理，免得一不小心就标题党：</p>

          <blockquote>
            <p style="font-size: 12pt;">电脑上挂着安卓模拟器，打开相应应用的二维码付款界面，定时截图，并将图复制到剪贴板，再利用脚本打开QQ好友界面，粘贴图片并发送信息。</p>
            <p style="font-size: 12pt;">相当简单粗暴的一个方法，风险当然也是有的，就是如果别有用心的人想要抓个包，你分分钟就丢了一大笔钱了（不知道支付宝和微信支付有没有限额的措施）</p>
          </blockquote>

          <br>

          <p>这玩意花了我将近一周的时间，中间也遇到不少波折。没办法毕竟Too young too simple，连一个功能如此简单的小项目都能强行制造这么多困难_(:з」∠)_</p>
          <p>也跟大家分享下整个研究过程吧。请注意，本文技术含量可能低于各位大神的预期，而且<strong>废话特别多</strong>，大家当周记来看就好~</p>
          <p>首先是Android模拟器的选择。据说Genymotion是公认的坠快的膜拟器，而且还能很方便的改IMEI（防止被一些应用识别为虚拟机而封号），毫不犹豫下载一个。</p>
          <p>然后试跑一下我要用于实验的应用，也就是我们公司所在园区的一款支付应用——</p>
          <p>{图}</p>
          <p>结果刚装完，闪退_(:з」∠)_</p>
          <p>{图}</p>
          <p>不带这么玩的啊喂！项目一开始就面临夭折？</p>
          <p>然后不甘心Google了一下，发现可以通过logcat查看异常信息</p>
          <pre>
E/AndroidRuntime( 1175): FATAL EXCEPTION: main
E/AndroidRuntime( 1175): java.lang.ExceptionInInitializerError
E/AndroidRuntime( 1175):        at cn.jpush.android.service.ServiceInterface.a(U
nknown Source)
E/AndroidRuntime( 1175):        at cn.jpush.android.api.JPushInterface.init(Unkn
own Source)
E/AndroidRuntime( 1175):        at cn.flyrise.MyApplication.b(Unknown Source)
E/AndroidRuntime( 1175):        at cn.flyrise.MyApplication.onCreate(Unknown Sou
rce)
E/AndroidRuntime( 1175):        at android.app.Instrumentation.callApplicationOn
Create(Instrumentation.java:999)
E/AndroidRuntime( 1175):        at android.app.ActivityThread.handleBindApplicat
ion(ActivityThread.java:4151)
E/AndroidRuntime( 1175):        at android.app.ActivityThread.access$1300(Activi
tyThread.java:130)
E/AndroidRuntime( 1175):        at android.app.ActivityThread$H.handleMessage(Ac
tivityThread.java:1255)
E/AndroidRuntime( 1175):        at android.os.Handler.dispatchMessage(Handler.ja
va:99)
E/AndroidRuntime( 1175):        at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime( 1175):        at android.app.ActivityThread.main(ActivityThrea
d.java:4745)
E/AndroidRuntime( 1175):        at java.lang.reflect.Method.invokeNative(Native
Method)
E/AndroidRuntime( 1175):        at java.lang.reflect.Method.invoke(Method.java:5
11)
E/AndroidRuntime( 1175):        at com.android.internal.os.ZygoteInit$MethodAndA
rgsCaller.run(ZygoteInit.java:786)
E/AndroidRuntime( 1175):        at com.android.internal.os.ZygoteInit.main(Zygot
eInit.java:553)
E/AndroidRuntime( 1175):        at dalvik.system.NativeStart.main(Native Method)

E/AndroidRuntime( 1175): Caused by: java.lang.UnsatisfiedLinkError: Couldn't loa
d jpush180: findLibrary returned null
E/AndroidRuntime( 1175):        at java.lang.Runtime.loadLibrary(Runtime.java:36
5)
E/AndroidRuntime( 1175):        at java.lang.System.loadLibrary(System.java:535)

E/AndroidRuntime( 1175):        at cn.jpush.android.service.PushProtocol.<clinit
>(Unknown Source)
E/AndroidRuntime( 1175):        ... 16 more</pre>
          <p>发现闪退是由于缺了一个叫jpush180的库文件（注：极光推送的运行库）</p>

          <!--
          <p>下面上步骤：</p>
          <p>1. 安装一个安卓模拟器，建议使用可以模拟指定机型及IMEI的模拟器，避免被封号（这里我用的是 “逍遥安卓模拟器” ）；</p>
          <p>2. 从QQ好友中找自己的小号（当然如果你能找到一个无论你怎么狂发信息他都不觉得烦的好友也行= =），右键，选创建快捷方式，然后右击快捷方式选属性，记住目标位置那一长串字符串；</p>
          <p>3. 编写如下C#程序，并生成exe（如果你的电脑能直接运行我提供的exe可直接跳过这步）；</p>
          <p>4. 编写如下vbs脚本（adb位置及图片位置自行指定）；</p>
          <p>5. 准备就绪，打开安卓模拟器的二维码付款界面，登录QQ，adb连接上；</p>
          <p>6. 打开计划任务，新建计划任务，指定vbs文件的位置以及运行时间间隔。</p>
          <p>以上步骤完毕后，你就可以出去用你的WP机进行扫码付款了！只需在付款时打开QQ，找到前面指定的好友，打开最近发送的一张图片，即可付款。</p>
          -->

        </div>

        <div class="col-md-4">
          <div class="panel panel-info">
            <div class="panel-heading">
              <h3 class="panel-title">Info</h3>
            </div>
            <div class="panel-body">
              <ul style="list-style-type: none; padding-left: 10px;">
                <li>系统：
                  <ul>
                    <li>Windows Phone/Windows 10 Mobile</li>
                    <li>Android</li>
                  </ul>
                </li>
                <br>
                <li>涉及语言：VBS、C#、smali</li>
                <br>
                <li>需要的程序、应用：
                  <ul>
                    <li>安卓虚拟机</li>
                    <li>Visual Studio（用于编译C#）</li>
                    <li>adb.exe</li>
                    <li>apktool.jar</li>
                    <li>signapk.jar</li>
                  </ul>
                </li>
                <br>
                <li>关键字：脚本、计划任务、Android反编译</li>
              </ul>

            </div>
          </div>
        </div>

      </div>

      <footer id="sce-footer"></footer>

      <div id="sce-fixed-btn"></div>

    </div>

    <script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/js/cosmo-custom.js"></script>
    <script type="text/javascript" src="/js/sce-add.js"></script>
  </body>
</html>